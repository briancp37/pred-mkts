# [0-2] Config schema for per-exchange limits
[Back to task list](tasks.md)

## Description
YAML file (e.g., `config/limits.yml`) with entries:
```yaml
exchanges:
  polymarket:
    host: api.polymarket.com
    steady_rate: 10      # tokens/sec (default)
    burst: 20
    max_concurrency: 4
    headers:
      retry_after: Retry-After
      limit: X-RateLimit-Limit
      remaining: X-RateLimit-Remaining
      reset: X-RateLimit-Reset
    buckets:
      - key: "global"                  # group endpoints if needed
        pattern: "/v{1,}/.*"          # regex
        share_with: ["orders", "markets"]
```

## Status History
| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-10-15 00:00:00 | Created | N/A | Proposed | Task created | User |
| 2025-10-15 00:30:00 | Status Change | Proposed | Review | Implementation complete, all tests passing | AI Agent |
| 2025-10-15 01:30:00 | Status Change | Review | Done | PR Accepted | user |

## Requirements
- Schema validation (simple).
- Grep anchors # [CTX:PBI-0:0-2:CFG].

## Implementation Plan
1. Create `config/` directory structure
2. Create `config/limits.yml` with schema example for polymarket
3. Create `src/pred_mkts/core/config.py` module with:
   - `ExchangeConfig` class for individual exchange configuration
   - `LimitsConfig` class for managing all exchange configs
   - `load_config()` function with fallback to defaults when file missing
   - `validate_config()` function for schema validation
   - Grep anchor [CTX:PBI-0:0-2:CFG]
4. Create comprehensive unit tests in `tests/unit/test_config.py`
5. Update `docs/delivery/registry.yml` to track new files

## Verification
- Load/validate config; fallbacks if missing.
- All unit tests pass (29 tests created and passing)
- Validation catches malformed configs
- Default config returned when file not found

## Files Modified
- `config/limits.yml` (created) - Example config with polymarket exchange
- `src/pred_mkts/core/config.py` (created) - Config loading and validation module
- `tests/unit/test_config.py` (created) - Comprehensive unit tests (29 tests)
- `docs/delivery/registry.yml` (updated) - Added config.py and limits.yml
- `docs/delivery/0/tasks.md` (updated) - Status changed to Review
- `docs/delivery/_state.md` (updated) - Updated active task to 0-2
- `tools/update_state.py` (updated) - Updated touchpoints for task 0-2
